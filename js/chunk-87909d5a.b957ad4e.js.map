{"version":3,"sources":["webpack:///./src/views/MemberGroupForm.vue?c1fc","webpack:///./src/apis/MemberGroupApi.ts","webpack:///./src/views/MemberGroupForm.vue","webpack:///./src/views/MemberGroupForm.vue?8cdd","webpack:///./src/views/MemberGroupForm.vue?f687","webpack:///./src/views/MemberGroupForm.vue?560b"],"names":["render","_vm","this","_h","$createElement","_c","_self","staticClass","_v","_s","$t","on","$event","preventDefault","submit","apply","arguments","model","value","callback","$$v","valid","expression","attrs","rules","memberGroupCode","staticRenderFns","uniqueName","body","post","result","data","uuid","memberGroupId","store","state","userId","Promise","reject","Error","extend","components","v","i18n","t","watch","replace","ch","String","fromCharCode","charCodeAt","mounted","$route","query","name","uniqueNum","methods","nameToUuid","addMember","isInClient","sendMsg","sendMessages","type","text","closeWindow","$store","commit","$router","push","handleError","error","response","status","$notify","title","toString","component","VBtn","VCol","VContainer","VForm","VRow","VTextField"],"mappings":"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","file":"js/chunk-87909d5a.b957ad4e.js","sourcesContent":["var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"userInfo\"},[_c('h1',[_vm._v(\" \"+_vm._s(_vm.$t('請填入班級代號'))+\" \")]),_c('v-form',{on:{\"submit\":function($event){$event.preventDefault();return _vm.submit.apply(null, arguments)}},model:{value:(_vm.valid),callback:function ($$v) {_vm.valid=$$v},expression:\"valid\"}},[_c('v-container',{staticClass:\"container\"},[_c('v-row',[_c('v-col',{attrs:{\"cols\":\"12\",\"md\":\"12\"}},[_c('v-text-field',{attrs:{\"rules\":_vm.rules,\"label\":_vm.$t('班級代號（請注意英文大小寫）'),\"required\":\"\"},model:{value:(_vm.memberGroupCode),callback:function ($$v) {_vm.memberGroupCode=$$v},expression:\"memberGroupCode\"}})],1)],1),_c('v-btn',{staticClass:\"mt-5\",attrs:{\"type\":\"submit\",\"disabled\":!_vm.valid}},[_vm._v(\" \"+_vm._s(_vm.$t('送出'))+\" \")])],1)],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import store from '@/store';\nimport api from './BaseApi';\n\nexport default class MemberGroupApi {\n  static async nameToUuid(uniqueName: string): Promise<string> {\n    const body = {\n      uniqueName,\n    };\n    const result = await api.post('workspace/member-groups/name-to-id/', body);\n\n    return result.data.uuid;\n  }\n\n  static async addMember(memberGroupId: string): Promise<void> {\n    if (store.state.userId) {\n      const body = {\n        userId: store.state.userId,\n      };\n      const result = await api.post(`workspace/member-groups/${memberGroupId}/members/`, body);\n      return result.data;\n    }\n\n    return Promise.reject(new Error('userId not found, failed to update profile'));\n  }\n}\n","\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\n\nimport liff from '@line/liff';\nimport MemberGroupApi from '@/apis/MemberGroupApi';\nimport Vue from 'vue';\nimport i18n from '@/i18n';\n\nexport default Vue.extend({\n  components: {\n  },\n  data: () => ({\n    valid: false,\n    memberGroupCode: '',\n    rules: [\n      (v: string) => !!v || i18n.t('必填'),\n    ],\n  }),\n  watch: {\n    memberGroupCode() {\n      // replace fullwidth with halfwidth\n      this.memberGroupCode = this.memberGroupCode.replace(\n        /[\\uff01-\\uff5e]/g,\n        (ch) => String.fromCharCode(ch.charCodeAt(0) - 0xfee0),\n      );\n    },\n  },\n  mounted() {\n    if (this.$route.query.name && this.$route.query.uniqueNum) {\n      this.memberGroupCode = `${String(this.$route.query.name)}#${String(this.$route.query.uniqueNum)}`;\n    } else {\n      this.memberGroupCode = '';\n    }\n  },\n  methods: {\n    async submit() {\n      try {\n        const memberGroupId = await MemberGroupApi.nameToUuid(this.memberGroupCode);\n        await MemberGroupApi.addMember(memberGroupId);\n\n        if (liff.isInClient() && this.$route.query.sendMsg) {\n          liff.sendMessages([{\n            type: 'text',\n            text: '填寫完成！',\n          }]);\n          liff.closeWindow();\n        }\n        this.$store.commit('updateMemberGroupCode', this.memberGroupCode);\n        this.$router.push('/SuccessPage');\n      } catch (error) {\n        this.handleError(error);\n      }\n    },\n\n    // eslint-disable-next-line @typescript-eslint/no-explicit-any\n    handleError(error: any) {\n      if (error.response && error.response.status === 404) {\n        this.$notify({\n          type: 'error',\n          title: this.$t('加入失敗').toString(),\n          text: this.$t('您所輸入的班級不存在，請檢查是否輸入正確').toString(),\n        });\n      } else {\n        this.$notify({\n          type: 'error',\n          title: this.$t('加入失敗').toString(),\n          text: this.$t('未知的原因造成失敗，請稍後重試，若持續失敗，麻煩請聯絡客服人員').toString(),\n        });\n        throw error;\n      }\n    },\n  },\n});\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MemberGroupForm.vue?vue&type=script&lang=ts&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--14-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/ts-loader/index.js??ref--14-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MemberGroupForm.vue?vue&type=script&lang=ts&\"","import { render, staticRenderFns } from \"./MemberGroupForm.vue?vue&type=template&id=10dea35e&scoped=true&\"\nimport script from \"./MemberGroupForm.vue?vue&type=script&lang=ts&\"\nexport * from \"./MemberGroupForm.vue?vue&type=script&lang=ts&\"\nimport style0 from \"./MemberGroupForm.vue?vue&type=style&index=0&id=10dea35e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"10dea35e\",\n  null\n  \n)\n\nexport default component.exports\n\n/* vuetify-loader */\nimport installComponents from \"!../../node_modules/vuetify-loader/lib/runtime/installComponents.js\"\nimport { VBtn } from 'vuetify/lib/components/VBtn';\nimport { VCol } from 'vuetify/lib/components/VGrid';\nimport { VContainer } from 'vuetify/lib/components/VGrid';\nimport { VForm } from 'vuetify/lib/components/VForm';\nimport { VRow } from 'vuetify/lib/components/VGrid';\nimport { VTextField } from 'vuetify/lib/components/VTextField';\ninstallComponents(component, {VBtn,VCol,VContainer,VForm,VRow,VTextField})\n","export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-2!../../node_modules/sass-loader/dist/cjs.js??ref--8-oneOf-1-3!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./MemberGroupForm.vue?vue&type=style&index=0&id=10dea35e&lang=scss&scoped=true&\""],"sourceRoot":""}